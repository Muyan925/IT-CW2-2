{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  name: \"PlanManage\",\n  data() {\n    return {\n      addDialogFormVisible: false,\n      addPlan: true,\n      dialogTitle: \"添加学习计划\",\n      plans: [],\n      multipleSelection: [],\n      plan: {\n        uId: \"\",\n        planName: \"\",\n        planStress: \"\",\n        planInfo: \"\",\n        startTime: \"\",\n        endTime: \"\",\n        planStatus: 0\n      }\n    };\n  },\n  computed: {\n    uid() {\n      return this.$store.getters[\"getUserId\"];\n    }\n  },\n  methods: {\n    showAddDialog() {\n      this.plan = {};\n      this.dialogTitle = \"添加学习计划\";\n      this.addDialogFormVisible = true;\n      this.addPlan = true;\n    },\n    showModifyDialog(pid) {\n      this.addDialogFormVisible = true;\n      this.dialogTitle = \"编辑学习计划\";\n      this.addPlan = false;\n      this.$axios.get(`Plan/ShowPlanBasicInfoByPid/${pid}`).then(response => {\n        if (response.data.flag) {\n          this.plan = response.data.data;\n        } else {\n          this.$message.error(response.data.msg);\n        }\n      });\n    },\n    handleDelete(pid) {\n      this.$confirm(\"此操作将永久删除此条记录, 是否继续?\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        this.$axios.post(`/Plan/DeleteSinglePlanByPid/${pid}`).then(response => {\n          if (response.data.flag) {\n            this.$message.success(response.data.msg);\n          } else {\n            this.$message.error(response.data.msg);\n          }\n        });\n      }).catch(() => {\n        this.$message({\n          type: \"info\",\n          message: \"已取消删除\"\n        });\n      });\n    },\n    handleMultipleDelete() {\n      if (this.multipleSelection.length === 0) {\n        this.$message.info(\"请先选中数据\");\n        return;\n      }\n      this.$confirm(\"此操作将永久删除所有选中的记录, 是否继续?\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        let pids = [];\n        this.multipleSelection.forEach(item => {\n          pids.push(item.pId);\n        });\n        const formData = new FormData();\n        formData.append(\"pIds\", pids);\n        this.$axios.post(`/Plan/DeletePlansByPids`, formData).then(response => {\n          if (response.data.flag) {\n            this.$message.success(response.data.msg);\n            this.getPlansList();\n          } else {\n            this.$message.error(response.data.msg);\n          }\n        });\n      }).catch(() => {\n        this.$message({\n          type: \"info\",\n          message: \"已取消删除\"\n        });\n      });\n    },\n    handleModify() {\n      this.$axios.post(\"/Plan/UpdatePlanBasicInfo\", this.plan).then(response => {\n        if (response.data.flag) {\n          this.$message.success(response.data.msg);\n          this.addDialogFormVisible = false;\n          this.getPlansList();\n        } else {\n          this.$message.error(response.data.msg);\n        }\n      });\n    },\n    handleAddPlan() {\n      this.plan.uId = this.uid;\n      if (this.addPlan) {\n        this.$axios.post(\"/Plan/AddPlans\", this.plan).then(response => {\n          if (response.data.flag) {\n            this.$message.success(response.data.msg);\n            this.addDialogFormVisible = false;\n            this.getPlansList();\n          } else {\n            this.$message.error(response.data.msg);\n          }\n        });\n      } else {\n        this.handleModify();\n      }\n    },\n    handleSelectionChange(v) {\n      this.multipleSelection = v;\n    },\n    getPlansList() {\n      this.$axios.get(`/Plan/GetAllPlansByUid/${this.uid}`).then(response => {\n        console.log(response.data);\n        if (response.data.flag) {\n          this.plans = response.data.data;\n        } else {\n          this.$message.error(response.data.msg);\n        }\n      });\n    }\n  },\n  created() {\n    this.getPlansList();\n  }\n};","map":{"version":3,"mappings":";AAoGA;EACAA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;IACA;EACA;EACAC;IACAC;MACA;IACA;EACA;EACAC;IACAC;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;QACA;UACA;QACA;UACA;QACA;MACA;IACA;IACAC;MACA;QACAC;QACAC;QACAC;MACA,GACAC;QACA,YACAC,2CACAD;UACA;YACA;UACA;YACA;UACA;QACA;MACA,GACAE;QACA;UACAH;UACAI;QACA;MACA;IACA;IACAC;MACA;QACA;QACA;MACA;MACA;QACAP;QACAC;QACAC;MACA,GACAC;QACA;QACA;UACAK;QACA;QACA;QACAC;QACA,YACAL,0CACAD;UACA;YACA;YACA;UACA;YACA;UACA;QACA;MACA,GACAE;QACA;UACAH;UACAI;QACA;MACA;IACA;IACAI;MACA,YACAN,6CACAD;QACA;UACA;UACA;UACA;QACA;UACA;QACA;MAEA;IACA;IACAQ;MACA;MACA;QAEA;UACA;YACA;YACA;YACA;UACA;YACA;UACA;QAEA;MACA;QACA;MACA;IAEA;IACAC;MACA;IACA;IACAC;MACA;QACAC;QACA;UACA;QACA;UACA;QACA;MACA;IACA;EACA;EACAC;IACA;EACA;AACA","names":["name","data","addDialogFormVisible","addPlan","dialogTitle","plans","multipleSelection","plan","uId","planName","planStress","planInfo","startTime","endTime","planStatus","computed","uid","methods","showAddDialog","showModifyDialog","handleDelete","confirmButtonText","cancelButtonText","type","then","post","catch","message","handleMultipleDelete","pids","formData","handleModify","handleAddPlan","handleSelectionChange","getPlansList","console","created"],"sourceRoot":"src/pages","sources":["PlanManage.vue"],"sourcesContent":["<template>\n    <div class=\"plan-manage\">\n        <div class=\"title\">\n            <span class=\"name\">计划管理</span>\n        </div>\n        <div class=\"content\">\n            <div class=\"opts\">\n                <div class=\"filter-content\">\n                    <el-select v-model=\"value\" placeholder=\"请选择\" size=\"small\" style=\"width: 100px\">\n                        <el-option v-for=\"item in options\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\n                        </el-option>\n                    </el-select>\n                    <el-select v-model=\"value\" placeholder=\"请选择\" size=\"small\" style=\"width: 100px\">\n                        <el-option v-for=\"item in options\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\n                        </el-option>\n                    </el-select>\n                    <button class=\"filter btn\">筛选</button>\n                </div>\n                <div class=\"search-content\">\n                    <input type=\"text\" />\n                    <button class=\"search btn\">搜索</button>\n                </div>\n                <div>\n                    <button class=\"add-plan btn\" @click=\"showAddDialog\">新增计划</button>\n                    <button class=\"all-delete btn\" @click=\"handleMultipleDelete\">\n                        批量删除\n                    </button>\n                </div>\n            </div>\n            <el-table height=\"500\" ref=\"multipleTable\" :data=\"plans\" tooltip-effect=\"dark\"\n                style=\"width: 100%; border: 1px solid #ccc; margin-top: 20px\" @selection-change=\"handleSelectionChange\">\n                <el-table-column type=\"selection\" width=\"55\"> </el-table-column>\n                <el-table-column label=\"计划名称\" prop=\"planName\"> </el-table-column>\n                <el-table-column prop=\"startTime\" label=\"开始日期\" width=\"100\">\n                </el-table-column>\n                <el-table-column prop=\"endTime\" label=\"结束日期\" width=\"100\" show-overflow-tooltip>\n                </el-table-column>\n                <el-table-column prop=\"planStress\" label=\"重要度\" width=\"100\" show-overflow-tooltip>\n                </el-table-column>\n                <el-table-column label=\"状态\" width=\"100\" show-overflow-tooltip>\n                    <template slot-scope=\"scope\">\n                        {{ scope.row.planstatus === 0 ? '未完成' : '已完成' }}\n                    </template>\n                </el-table-column>\n                <el-table-column label=\"操作\" width=\"160\">\n                    <template slot-scope=\"scope\">\n                        <!-- <span class=\"delete\" @click=\"handleDelete(scope.row.pId)\">删除</span>\n                        <span class=\"modify\" @click=\"showModifyDialog(scope.row.pId)\">编辑</span> -->\n                        <el-button type=\"primary\" class=\"el-icon-edit\" size=\"small\" @click=\"showModifyDialog(scope.row.pId)\"></el-button>\n            <el-button type=\"danger\" class=\"el-icon-delete\" size=\"small\" @click=\"handleDelete(scope.row.pId)\"></el-button>\n                    </template>\n                </el-table-column>\n            </el-table>\n            <div class=\"pagination\">\n                <el-pagination background layout=\"prev, pager, next\" :total=\"1000\">\n                </el-pagination>\n            </div>\n        </div>\n\n        <el-dialog :title=\"dialogTitle\" :visible.sync=\"addDialogFormVisible\">\n            <el-form ref=\"form\" :model=\"plan\" label-width=\"80px\">\n                <el-form-item label=\"计划名称\">\n                    <el-input v-model=\"plan.planName\" style=\"width: 400px\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"计划描述\">\n                    <el-input v-model=\"plan.planInfo\" type=\"textarea\" rows=\"5\" show-word-limit maxlength=\"100\"\n                        style=\"width: 400px\"></el-input>\n                </el-form-item>\n\n                <el-form-item label=\"开始时间\">\n                    <el-date-picker value-format=\"yyyy-MM-dd\" v-model=\"plan.startTime\" style=\"width: 200px\" type=\"date\"\n                        placeholder=\"选择日期\"></el-date-picker>\n                </el-form-item>\n                <el-form-item label=\"结束时间\">\n                    <el-date-picker value-format=\"yyyy-MM-dd\" v-model=\"plan.endTime\" style=\"width: 200px\" type=\"date\"\n                        placeholder=\"选择日期\"></el-date-picker>\n                </el-form-item>\n                <el-form-item label=\"重要性\">\n                    <el-select v-model=\"plan.planStress\" style=\"width: 200px\" placeholder=\"请选择计划重要性\">\n                        <el-option label=\"P1\" value=\"P1\"></el-option>\n                        <el-option label=\"P2\" value=\"P2\"></el-option>\n                        <el-option label=\"P3\" value=\"P3\"></el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item label=\"状态\" v-show=\"!addPlan\">\n                    <el-select v-model=\"plan.planStatus\" style=\"width: 200px\" placeholder=\"请选择计划完成状态\">\n                        <el-option label=\"未完成\" value=\"0\"></el-option>\n                        <el-option label=\"已完成\" value=\"1\"></el-option>\n                    </el-select>\n                </el-form-item>\n            </el-form>\n            <div slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"addDialogFormVisible = false\">取 消</el-button>\n                <el-button type=\"primary\" @click=\"handleAddPlan\">确 定</el-button>\n            </div>\n        </el-dialog>\n    </div>\n</template>\n  \n<script>\nexport default {\n    name: \"PlanManage\",\n    data() {\n        return {\n            addDialogFormVisible: false,\n            addPlan: true,\n            dialogTitle: \"添加学习计划\",\n            plans: [],\n            multipleSelection: [],\n            plan: {\n                uId: \"\",\n                planName: \"\",\n                planStress: \"\",\n                planInfo: \"\",\n                startTime: \"\",\n                endTime: \"\",\n                planStatus: 0\n            },\n        };\n    },\n    computed: {\n        uid() {\n            return this.$store.getters[\"getUserId\"];\n        },\n    },\n    methods: {\n        showAddDialog() {\n            this.plan = {};\n            this.dialogTitle = \"添加学习计划\";\n            this.addDialogFormVisible = true;\n            this.addPlan = true;\n        },\n        showModifyDialog(pid) {\n            this.addDialogFormVisible = true;\n            this.dialogTitle = \"编辑学习计划\";\n            this.addPlan = false;\n            this.$axios.get(`Plan/ShowPlanBasicInfoByPid/${pid}`).then((response) => {\n                if (response.data.flag) {\n                    this.plan = response.data.data;\n                } else {\n                    this.$message.error(response.data.msg);\n                }\n            });\n        },\n        handleDelete(pid) {\n            this.$confirm(\"此操作将永久删除此条记录, 是否继续?\", \"提示\", {\n                confirmButtonText: \"确定\",\n                cancelButtonText: \"取消\",\n                type: \"warning\",\n            })\n                .then(() => {\n                    this.$axios\n                        .post(`/Plan/DeleteSinglePlanByPid/${pid}`)\n                        .then((response) => {\n                            if (response.data.flag) {\n                                this.$message.success(response.data.msg);\n                            } else {\n                                this.$message.error(response.data.msg);\n                            }\n                        });\n                })\n                .catch(() => {\n                    this.$message({\n                        type: \"info\",\n                        message: \"已取消删除\",\n                    });\n                });\n        },\n        handleMultipleDelete() {\n            if (this.multipleSelection.length === 0) {\n                this.$message.info(\"请先选中数据\");\n                return;\n            }\n            this.$confirm(\"此操作将永久删除所有选中的记录, 是否继续?\", \"提示\", {\n                confirmButtonText: \"确定\",\n                cancelButtonText: \"取消\",\n                type: \"warning\",\n            })\n                .then(() => {\n                    let pids = [];\n                    this.multipleSelection.forEach((item) => {\n                        pids.push(item.pId);\n                    });\n                    const formData = new FormData();\n                    formData.append(\"pIds\", pids);\n                    this.$axios\n                        .post(`/Plan/DeletePlansByPids`, formData)\n                        .then((response) => {\n                            if (response.data.flag) {\n                                this.$message.success(response.data.msg);\n                                this.getPlansList();\n                            } else {\n                                this.$message.error(response.data.msg);\n                            }\n                        });\n                })\n                .catch(() => {\n                    this.$message({\n                        type: \"info\",\n                        message: \"已取消删除\",\n                    });\n                });\n        },\n        handleModify() {\n            this.$axios\n                .post(\"/Plan/UpdatePlanBasicInfo\", this.plan)\n                .then((response) => {\n                    if (response.data.flag) {\n                        this.$message.success(response.data.msg);\n                        this.addDialogFormVisible = false\n                        this.getPlansList()\n                    } else {\n                        this.$message.error(response.data.msg);\n                    }\n                    \n                });\n        },\n        handleAddPlan() {\n            this.plan.uId = this.uid;\n            if (this.addPlan) {\n                \n                this.$axios.post(\"/Plan/AddPlans\", this.plan).then((response) => {\n                    if (response.data.flag) {\n                        this.$message.success(response.data.msg);\n                        this.addDialogFormVisible = false\n                        this.getPlansList()\n                    } else {\n                        this.$message.error(response.data.msg);\n                    }\n                    \n                });\n            } else {\n                this.handleModify()\n            }\n            \n        },\n        handleSelectionChange(v) {\n            this.multipleSelection = v;\n        },\n        getPlansList() {\n            this.$axios.get(`/Plan/GetAllPlansByUid/${this.uid}`).then((response) => {\n                console.log(response.data);\n                if (response.data.flag) {\n                    this.plans = response.data.data;\n                } else {\n                    this.$message.error(response.data.msg);\n                }\n            });\n        },\n    },\n    created() {\n        this.getPlansList();\n    },\n};\n</script>\n  \n<style scoped>\n.title {\n    display: flex;\n    justify-content: space-between;\n    margin-bottom: 20px;\n}\n\n.title .name {\n    font-size: 24px;\n}\n\n.search-content input {\n    width: 600px;\n    height: 30px;\n    margin-right: 20px;\n    border-radius: 15px;\n    border: 1px solid rgb(189, 189, 189);\n    outline: none;\n    text-indent: 15px;\n    font-size: 16px;\n}\n\n.content {\n    position: relative;\n    padding: 12px;\n    border: 1px solid #ccc;\n    border-radius: 10px;\n}\n\n.opts {\n    display: flex;\n    justify-content: space-between;\n}\n\n.filter-content * {\n    margin-right: 10px;\n}\n\n.pagination {\n    display: flex;\n    width: 100%;\n    margin-top: 20px;\n    justify-content: center;\n}\n\n.add-plan {\n    margin-right: 10px;\n}\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}