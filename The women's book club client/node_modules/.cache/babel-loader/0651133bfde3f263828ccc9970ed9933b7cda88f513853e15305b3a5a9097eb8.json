{"ast":null,"code":"export default {\n  name: 'MarkdownView',\n  data() {\n    return {\n      text: ''\n    };\n  },\n  computed: {\n    name() {\n      return this.$route.query.name;\n    },\n    location() {\n      return this.$route.query.location;\n    }\n  },\n  methods: {\n    goBack() {\n      this.$router.go(-1);\n    },\n    getNoteInfo() {\n      this.$axios.get('/Note/GetNoteInfo?fileLocation=' + this.location).then(response => {\n        console.log(response.data);\n        if (response.data.flag) {\n          this.text = response.data.data;\n        } else {\n          this.$message.error(response.data.msg);\n        }\n      });\n    },\n    saveFile(text, html) {\n      console.log(text);\n      this.$axios.post('/notes/' + this.$route.query.location.substring(6), text, {\n        headers: {\n          \"Content-Type\": \"text/plain; charset=utf-8\"\n        }\n      }).then(response => {\n        if (response.data.flag) {\n          this.$message.success(response.data.msg);\n        } else {\n          this.$message.error(response.data.msg);\n        }\n      });\n    },\n    handleUploadImage(event, insertImage, files) {\n      // 拿到 files 之后上传到文件服务器，然后向编辑框中插入对应的内容\n      console.log(files);\n      const formData = new FormData();\n      formData.append('image', files[0]);\n      this.$axios.post('/notes/upload', formData).then(response => {\n        if (response.data.flag) {\n          this.$message.success(response.data.msg);\n          insertImage({\n            url: response.data.data,\n            desc: files[0].name,\n            width: 'auto',\n            height: 'auto'\n          });\n        } else {\n          this.$message.error(response.data.msg);\n        }\n      });\n    }\n  },\n  mounted() {\n    this.getNoteInfo();\n  }\n};","map":{"version":3,"mappings":"AAeA;EACAA;EACAC;IACA;MACAC;IACA;EACA;EACAC;IACAH;MACA;IACA;IACAI;MACA;IACA;EACA;EACAC;IACAC;MACA;IACA;IACAC;MACA;QACAC;QACA;UACA;QACA;UACA;QACA;MACA;IACA;IACAC;MACAD;MACA;QACAE;UACA;QACA;MACA;QACA;UACA;QACA;UACA;QACA;MACA;IACA;IACAC;MACA;MACAH;MACA;MACAI;MAEA;QACA;UACA;UACAC;YACAC;YACAC;YACAC;YACAC;UACA;QACA;UACA;QACA;MACA;IAEA;EACA;EACAC;IACA;EACA;AACA","names":["name","data","text","computed","location","methods","goBack","getNoteInfo","console","saveFile","headers","handleUploadImage","formData","insertImage","url","desc","width","height","mounted"],"sourceRoot":"src/pages","sources":["MarkdownView.vue"],"sourcesContent":["<template>\n  <div class=\"view\">\n    <div class=\"title\">\n        笔记管理-编辑笔记\n        <div class=\"right\">\n            <span class=\"note-name\">{{name}}</span>\n            <span class=\"download\"><a :href='\"http://localhost:8081\" + location' download :target=\"location\">下载</a></span>\n        </div>\n    </div>\n    <v-md-editor v-model=\"text\" height=\"80vh\" @save=\"saveFile\" @upload-image=\"handleUploadImage\" :disabled-menus=\"[]\"></v-md-editor>\n  </div>\n</template>\n\n<script>\n\nexport default {\n    name: 'MarkdownView',\n    data() {\n        return {\n            text: '',\n        }\n    },\n    computed: {\n        name() {\n            return this.$route.query.name\n        },\n        location() {\n            return this.$route.query.location\n        }\n    },\n    methods: {\n        goBack() {\n            this.$router.go(-1)\n        },\n        getNoteInfo() {\n            this.$axios.get('/Note/GetNoteInfo?fileLocation=' + this.location).then(response => {\n                console.log(response.data);\n                if (response.data.flag) {\n                    this.text = response.data.data\n                } else {\n                    this.$message.error(response.data.msg)\n                }\n            })\n        },\n        saveFile(text, html) {\n            console.log(text);\n            this.$axios.post('/notes/' + this.$route.query.location.substring(6), text,{\n                headers: {\n                    \"Content-Type\": \"text/plain; charset=utf-8\"\n                }\n            }).then(response => {\n                if (response.data.flag) {\n                    this.$message.success(response.data.msg)\n                } else {\n                    this.$message.error(response.data.msg)\n                }\n            })\n        },\n        handleUploadImage(event, insertImage, files) {\n            // 拿到 files 之后上传到文件服务器，然后向编辑框中插入对应的内容\n            console.log(files);\n            const formData = new FormData()\n            formData.append('image', files[0])\n\n            this.$axios.post('/notes/upload', formData).then(response => {\n                if (response.data.flag) {\n                    this.$message.success(response.data.msg)\n                    insertImage({\n                        url: response.data.data,\n                        desc: files[0].name,\n                        width: 'auto',\n                        height: 'auto',\n                    });\n                } else {\n                    this.$message.error(response.data.msg)\n                }\n            })\n\n        },\n    },\n    mounted() {\n        this.getNoteInfo()\n    },\n}\n</script>\n\n<style scoped>\n.title {\n    font-size: 24px;\n    margin-bottom: 20px;\n}\n\n.v-md-editor {\n    overflow: hidden;\n    border-radius: 10px;\n    /* border: 1px solid #ccc;\n    box-shadow: none; */\n\n}\n\n.title {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-end;\n    /* background-color: pink; */\n}\n\n.right {\n    display: flex;\n    align-items: flex-end;\n    font-size: 16px;\n}\n\n.right .note-name {\n    /* background-color: red; */\n    margin-right: 10px;\n    font-size: 20px;\n    color: rgb(72, 176, 250);\n}\n\n.download {\n    font-size: 16px;\n    color: #575757;\n    cursor: pointer;\n}\n\n.download:hover {\n    color: rgb(63, 147, 231);\n    text-decoration: underline;\n}\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}